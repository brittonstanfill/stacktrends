var Sequelize = require('sequelize');
var express = require('express');
var request = require('request');

var app = express();

function serverApi(){
	console.log('ServerApi awaiting your orders!');


app.use(express.bodyParser());

app.get('/', function(req, res){

	request("https://api.github.com/search/repositories?q=forks:>=5000", function(error, response, body) {
		var apiResponse = JSON.parse(body);
		console.log(apiResponse.total_count);


	  // var apiResponse = res;
	  // console.log(res);

		var output = '';

		for (var i=0; i<apiResponse['items'].length; i++){
		    var bit = apiResponse['items'][i];
		    output += '[name: "' + bit['name'] +
		        '", updated: "' + bit['updated_at'] +
		        '", fork: "' + bit['forks_count'] +
		        ']\n';
		};
		console.log(output);
	});

    // res.send('completed get request');
    // console.log('we hitting get');
});
}

module.exports = serverApi;